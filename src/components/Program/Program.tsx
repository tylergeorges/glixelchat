import { ProgramContent } from "./ProgramContent";
import { useDragging } from "../../hooks/useDragging";
import { Editor, PixelJSON } from "../PixelEditor/Editor";
import { RenderPix } from "../PixelEditor/RenderPix";
import { TitleBar } from "./TitleBar";
import { ProgramProps } from "./program.types";
import { useDesktopContext } from "../../util/DesktopContext";
import { useCallback, useState } from "react";
import Link from "next/link";
import { useRouter } from "next/router";

// const topbar ={
//     "1": {
//         "1": "#ff7eb6",
//         "2": "#ff7eb6",
//         "3": "#ff7eb6",
//         "4": "#ff7eb6",
//         "5": "#ff7eb6",
//         "6": "#ff7eb6",
//         "7": "#ff7eb6",
//         "8": "#ff7eb6",
//         "9": "#ff7eb6",
//         "10": "#ff7eb6",
//         "11": "#ff7eb6",
//         "12": "#ff7eb6",
//         "13": "#ff7eb6",
//         "14": "#ff7eb6",
//         "15": "#ff7eb6",
//         "16": "#ff7eb6",
//         "17": "#ff7eb6",
//         "18": "#ff7eb6",
//         "19": "#ff7eb6",
//         "20": "#ff7eb6",
//         "21": "#ff7eb6",
//         "22": "#ff7eb6",
//         "23": "#ff7eb6",
//         "24": "#ff7eb6",
//         "25": "#ff7eb6",
//         "26": "#ff7eb6",
//         "27": "#ff7eb6",
//         "28": "#ff7eb6",
//         "29": "#ff7eb6",
//         "30": "#ff7eb6",
//         "31": "#ff7eb6",
//         "32": "#ff7eb6",
//         "33": "#ff7eb6",
//         "34": "#ff7eb6",
//         "35": "#ff7eb6",
//         "36": "#ff7eb6",
//         "37": "#ff7eb6",
//         "38": "#ff7eb6",
//         "39": "#ff7eb6",
//         "40": "#ff7eb6",
//         "41": "#ff7eb6",
//         "42": "#ff7eb6",
//         "43": "#ff7eb6",
//         "44": "#ff7eb6",
//         "45": "#ff7eb6",
//         "46": "#ff7eb6",
//         "47": "#ff7eb6",
//         "48": "#ff7eb6",
//         "49": "#ff7eb6",
//         "50": "#ff7eb6",
//         "51": "#ff7eb6",
//         "52": "#ff7eb6",
//         "53": "#ff7eb6",
//         "54": "#ff7eb6",
//         "55": "#ff7eb6",
//         "56": "#ff7eb6",
//         "57": "#ff7eb6",
//         "58": "#ff7eb6",
//         "59": "#ff7eb6",
//         "60": "#ff7eb6",
//         "61": "#ff7eb6",
//         "62": "#ff7eb6",
//         "63": "#ff7eb6",
//         "64": "#ff7eb6"
//     },
//     "2": {
//         "0": "#ff7eb6",
//         "1": "#ff7eb6",
//         "2": "#ff7eb6",
//         "3": "#ff7eb6",
//         "4": "#ff7eb6",
//         "5": "#ff7eb6",
//         "6": "#ff7eb6",
//         "7": "#ff7eb6",
//         "8": "#ff7eb6",
//         "9": "#ff7eb6",
//         "10": "#ff7eb6",
//         "11": "#ff7eb6",
//         "12": "#ff7eb6",
//         "13": "#ff7eb6",
//         "14": "#ff7eb6",
//         "15": "#ff7eb6",
//         "16": "#ff7eb6",
//         "17": "#ff7eb6",
//         "18": "#ff7eb6",
//         "19": "#ff7eb6",
//         "20": "#ff7eb6",
//         "21": "#ff7eb6",
//         "22": "#ff7eb6",
//         "23": "#ff7eb6",
//         "24": "#ff7eb6",
//         "25": "#ff7eb6",
//         "26": "#ff7eb6",
//         "27": "#ff7eb6",
//         "28": "#ff7eb6",
//         "29": "#ff7eb6",
//         "30": "#ff7eb6",
//         "31": "#ff7eb6",
//         "32": "#ff7eb6",
//         "33": "#ff7eb6",
//         "34": "#ff7eb6",
//         "35": "#ff7eb6",
//         "36": "#ff7eb6",
//         "37": "#ff7eb6",
//         "38": "#ff7eb6",
//         "39": "#ff7eb6",
//         "40": "#ff7eb6",
//         "41": "#ff7eb6",
//         "42": "#ff7eb6",
//         "43": "#ff7eb6",
//         "44": "#ff7eb6",
//         "45": "#ff7eb6",
//         "46": "#ff7eb6",
//         "47": "#ff7eb6",
//         "48": "#ff7eb6",
//         "49": "#ff7eb6",
//         "50": "#ff7eb6",
//         "51": "#ff7eb6",
//         "52": "#ff7eb6",
//         "53": "#ff7eb6",
//         "54": "#ff7eb6",
//         "55": "#ff7eb6",
//         "56": "#ff7eb6",
//         "57": "#ff7eb6",
//         "58": "#ff7eb6",
//         "59": "#ff7eb6",
//         "60": "#ff7eb6",
//         "61": "#ff7eb6",
//         "62": "#ff7eb6",
//         "63": "#ff7eb6",
//         "64": "#ff7eb6",
//         "65": "#ff7eb6"
//     },
//     "3": {
//         "0": "#ff7eb6",
//         "1": "#ff7eb6",
//         "2": "#ff7eb6",
//         "3": "#ff7eb6",
//         "4": "#ff7eb6",
//         "5": "#ff7eb6",
//         "6": "#ff7eb6",
//         "7": "#ff7eb6",
//         "8": "#ff7eb6",
//         "9": "#ff7eb6",
//         "10": "#ff7eb6",
//         "11": "#ff7eb6",
//         "12": "#ff7eb6",
//         "13": "#ff7eb6",
//         "14": "#ff7eb6",
//         "15": "#ff7eb6",
//         "16": "#ff7eb6",
//         "17": "#ff7eb6",
//         "18": "#ff7eb6",
//         "19": "#ff7eb6",
//         "20": "#ff7eb6",
//         "21": "#ff7eb6",
//         "22": "#ff7eb6",
//         "23": "#ff7eb6",
//         "24": "#ff7eb6",
//         "25": "#ff7eb6",
//         "26": "#ff7eb6",
//         "27": "#ff7eb6",
//         "28": "#ff7eb6",
//         "29": "#ff7eb6",
//         "30": "#ff7eb6",
//         "31": "#ff7eb6",
//         "32": "#ff7eb6",
//         "33": "#ff7eb6",
//         "34": "#ff7eb6",
//         "35": "#ff7eb6",
//         "36": "#ff7eb6",
//         "37": "#ff7eb6",
//         "38": "#ff7eb6",
//         "39": "#ff7eb6",
//         "40": "#ff7eb6",
//         "41": "#ff7eb6",
//         "42": "#ff7eb6",
//         "43": "#ff7eb6",
//         "44": "#ff7eb6",
//         "45": "#ff7eb6",
//         "46": "#ff7eb6",
//         "47": "#ff7eb6",
//         "48": "#ff7eb6",
//         "49": "#ff7eb6",
//         "50": "#ff7eb6",
//         "51": "#ff7eb6",
//         "52": "#ff7eb6",
//         "53": "#ff7eb6",
//         "54": "#ff7eb6",
//         "55": "#ff7eb6",
//         "56": "#ff7eb6",
//         "57": "#ff7eb6",
//         "58": "#ff7eb6",
//         "59": "#ff7eb6",
//         "60": "#ff7eb6",
//         "61": "#ff7eb6",
//         "62": "#ff7eb6",
//         "63": "#ff7eb6",
//         "64": "#ff7eb6",
//         "65": "#ff7eb6"
//     },
//     "4": {
//         "0": "#ff7eb6",
//         "1": "#ff7eb6",
//         "2": "#ff7eb6",
//         "3": "#ff7eb6",
//         "4": "#ff7eb6",
//         "5": "#ff7eb6",
//         "6": "#ff7eb6",
//         "7": "#ff7eb6",
//         "8": "#ff7eb6",
//         "9": "#ff7eb6",
//         "10": "#ff7eb6",
//         "11": "#ff7eb6",
//         "12": "#ff7eb6",
//         "13": "#ff7eb6",
//         "14": "#ff7eb6",
//         "15": "#ff7eb6",
//         "16": "#ff7eb6",
//         "17": "#ff7eb6",
//         "18": "#ff7eb6",
//         "19": "#ff7eb6",
//         "20": "#ff7eb6",
//         "21": "#ff7eb6",
//         "22": "#ff7eb6",
//         "23": "#ff7eb6",
//         "24": "#ff7eb6",
//         "25": "#ff7eb6",
//         "26": "#ff7eb6",
//         "27": "#ff7eb6",
//         "28": "#ff7eb6",
//         "29": "#ff7eb6",
//         "30": "#ff7eb6",
//         "31": "#ff7eb6",
//         "32": "#ff7eb6",
//         "33": "#ff7eb6",
//         "34": "#ff7eb6",
//         "35": "#ff7eb6",
//         "36": "#ff7eb6",
//         "37": "#ff7eb6",
//         "38": "#ff7eb6",
//         "39": "#ff7eb6",
//         "40": "#ff7eb6",
//         "41": "#ff7eb6",
//         "42": "#ff7eb6",
//         "43": "#ff7eb6",
//         "44": "#ff7eb6",
//         "45": "#ff7eb6",
//         "46": "#ff7eb6",
//         "47": "#ff7eb6",
//         "48": "#ff7eb6",
//         "49": "#ff7eb6",
//         "50": "#ff7eb6",
//         "51": "#ff7eb6",
//         "52": "#ff7eb6",
//         "53": "#ff7eb6",
//         "54": "#ff7eb6",
//         "55": "#ff7eb6",
//         "56": "#ff7eb6",
//         "57": "#ff7eb6",
//         "58": "#ff7eb6",
//         "59": "#ff7eb6",
//         "60": "#ff7eb6",
//         "61": "#ff7eb6",
//         "62": "#ff7eb6",
//         "63": "#ff7eb6",
//         "64": "#ff7eb6",
//         "65": "#ff7eb6"
//     },
//     "cell_size": 10
// } as PixelJSON

// const topbar = {
//     "0": {
//         "2": "#ff7eb6",
//         "3": "#ff7eb6",
//         "4": "#ff7eb6",
//         "5": "#ff7eb6",
//         "6": "#ff7eb6",
//         "7": "#ff7eb6",
//         "8": "#ff7eb6",
//         "9": "#ff7eb6",
//         "10": "#ff7eb6",
//         "11": "#ff7eb6",
//         "12": "#ff7eb6",
//         "13": "#ff7eb6",
//         "14": "#ff7eb6",
//         "15": "#ff7eb6",
//         "16": "#ff7eb6",
//         "17": "#ff7eb6",
//         "18": "#ff7eb6",
//         "19": "#ff7eb6",
//         "20": "#ff7eb6",
//         "21": "#ff7eb6",
//         "22": "#ff7eb6",
//         "23": "#ff7eb6",
//         "24": "#ff7eb6",
//         "25": "#ff7eb6",
//         "26": "#ff7eb6",
//         "27": "#ff7eb6",
//         "28": "#ff7eb6",
//         "29": "#ff7eb6",
//         "30": "#ff7eb6",
//         "31": "#ff7eb6",
//         "32": "#ff7eb6",
//         "33": "#ff7eb6",
//         "34": "#ff7eb6",
//         "35": "#ff7eb6",
//         "36": "#ff7eb6",
//         "37": "#ff7eb6",
//         "38": "#ff7eb6",
//         "39": "#ff7eb6",
//         "40": "#ff7eb6",
//         "41": "#ff7eb6",
//         "42": "#ff7eb6",
//         "43": "#ff7eb6",
//         "44": "#ff7eb6",
//         "45": "#ff7eb6",
//         "46": "#ff7eb6",
//         "47": "#ff7eb6",
//         "48": "#ff7eb6",
//         "49": "#ff7eb6",
//         "50": "#ff7eb6",
//         "51": "#ff7eb6",
//         "52": "#ff7eb6",
//         "53": "#ff7eb6",
//         "54": "#ff7eb6",
//         "55": "#ff7eb6",
//         "56": "#ff7eb6",
//         "57": "#ff7eb6",
//         "58": "#ff7eb6",
//         "59": "#ff7eb6",
//         "60": "#ff7eb6",
//         "61": "#ff7eb6",
//         "62": "#ff7eb6",
//         "63": "#ff7eb6"
//     },
//     "1": {
//         "1": "#ff7eb6",
//         "2": "#ff7eb6",
//         "3": "#ff7eb6",
//         "4": "#ff7eb6",
//         "5": "#ff7eb6",
//         "6": "#ff7eb6",
//         "7": "#ff7eb6",
//         "8": "#ff7eb6",
//         "9": "#ff7eb6",
//         "10": "#ff7eb6",
//         "11": "#ff7eb6",
//         "12": "#ff7eb6",
//         "13": "#ff7eb6",
//         "14": "#ff7eb6",
//         "15": "#ff7eb6",
//         "16": "#ff7eb6",
//         "17": "#ff7eb6",
//         "18": "#ff7eb6",
//         "19": "#ff7eb6",
//         "20": "#ff7eb6",
//         "21": "#ff7eb6",
//         "22": "#ff7eb6",
//         "23": "#ff7eb6",
//         "24": "#ff7eb6",
//         "25": "#ff7eb6",
//         "26": "#ff7eb6",
//         "27": "#ff7eb6",
//         "28": "#ff7eb6",
//         "29": "#ff7eb6",
//         "30": "#ff7eb6",
//         "31": "#ff7eb6",
//         "32": "#ff7eb6",
//         "33": "#ff7eb6",
//         "34": "#ff7eb6",
//         "35": "#ff7eb6",
//         "36": "#ff7eb6",
//         "37": "#ff7eb6",
//         "38": "#ff7eb6",
//         "39": "#ff7eb6",
//         "40": "#ff7eb6",
//         "41": "#ff7eb6",
//         "42": "#ff7eb6",
//         "43": "#ff7eb6",
//         "44": "#ff7eb6",
//         "45": "#ff7eb6",
//         "46": "#ff7eb6",
//         "47": "#ff7eb6",
//         "48": "#ff7eb6",
//         "49": "#ff7eb6",
//         "50": "#ff7eb6",
//         "51": "#ff7eb6",
//         "52": "#ff7eb6",
//         "53": "#ff7eb6",
//         "54": "#ff7eb6",
//         "55": "#ff7eb6",
//         "56": "#ff7eb6",
//         "57": "#ff7eb6",
//         "58": "#ff7eb6",
//         "59": "#ff7eb6",
//         "60": "#ff7eb6",
//         "61": "#ff7eb6",
//         "62": "#ff7eb6",
//         "63": "#ff7eb6",
//         "64": "#ff7eb6"
//     },
//     "2": {
//         "0": "#ff7eb6",
//         "1": "#ff7eb6",
//         "2": "#ff7eb6",
//         "3": "#ff7eb6",
//         "4": "#ff7eb6",
//         "5": "#ff7eb6",
//         "6": "#ff7eb6",
//         "7": "#ff7eb6",
//         "8": "#ff7eb6",
//         "9": "#ff7eb6",
//         "10": "#ff7eb6",
//         "11": "#ff7eb6",
//         "12": "#ff7eb6",
//         "13": "#ff7eb6",
//         "14": "#ff7eb6",
//         "15": "#ff7eb6",
//         "16": "#ff7eb6",
//         "17": "#ff7eb6",
//         "18": "#ff7eb6",
//         "19": "#ff7eb6",
//         "20": "#ff7eb6",
//         "21": "#ff7eb6",
//         "22": "#ff7eb6",
//         "23": "#ff7eb6",
//         "24": "#ff7eb6",
//         "25": "#ff7eb6",
//         "26": "#ff7eb6",
//         "27": "#ff7eb6",
//         "28": "#ff7eb6",
//         "29": "#ff7eb6",
//         "30": "#ff7eb6",
//         "31": "#ff7eb6",
//         "32": "#ff7eb6",
//         "33": "#ff7eb6",
//         "34": "#ff7eb6",
//         "35": "#ff7eb6",
//         "36": "#ff7eb6",
//         "37": "#ff7eb6",
//         "38": "#ff7eb6",
//         "39": "#ff7eb6",
//         "40": "#ff7eb6",
//         "41": "#ff7eb6",
//         "42": "#ff7eb6",
//         "43": "#ff7eb6",
//         "44": "#ff7eb6",
//         "45": "#ff7eb6",
//         "46": "#ff7eb6",
//         "47": "#ff7eb6",
//         "48": "#ff7eb6",
//         "49": "#ff7eb6",
//         "50": "#ff7eb6",
//         "51": "#ff7eb6",
//         "52": "#ff7eb6",
//         "53": "#ff7eb6",
//         "54": "#ff7eb6",
//         "55": "#ff7eb6",
//         "56": "#ff7eb6",
//         "57": "#ff7eb6",
//         "58": "#ff7eb6",
//         "59": "#ff7eb6",
//         "60": "#ff7eb6",
//         "61": "#ff7eb6",
//         "62": "#ff7eb6",
//         "63": "#ff7eb6",
//         "64": "#ff7eb6",
//         "65": "#ff7eb6"
//     },
//     "3": {
//         "0": "#ff7eb6",
//         "1": "#ff7eb6",
//         "2": "#ff7eb6",
//         "3": "#ff7eb6",
//         "4": "#ff7eb6",
//         "5": "#ff7eb6",
//         "6": "#ff7eb6",
//         "7": "#ff7eb6",
//         "8": "#ff7eb6",
//         "9": "#ff7eb6",
//         "10": "#ff7eb6",
//         "11": "#ff7eb6",
//         "12": "#ff7eb6",
//         "13": "#ff7eb6",
//         "14": "#ff7eb6",
//         "15": "#ff7eb6",
//         "16": "#ff7eb6",
//         "17": "#ff7eb6",
//         "18": "#ff7eb6",
//         "19": "#ff7eb6",
//         "20": "#ff7eb6",
//         "21": "#ff7eb6",
//         "22": "#ff7eb6",
//         "23": "#ff7eb6",
//         "24": "#ff7eb6",
//         "25": "#ff7eb6",
//         "26": "#ff7eb6",
//         "27": "#ff7eb6",
//         "28": "#ff7eb6",
//         "29": "#ff7eb6",
//         "30": "#ff7eb6",
//         "31": "#ff7eb6",
//         "32": "#ff7eb6",
//         "33": "#ff7eb6",
//         "34": "#ff7eb6",
//         "35": "#ff7eb6",
//         "36": "#ff7eb6",
//         "37": "#ff7eb6",
//         "38": "#ff7eb6",
//         "39": "#ff7eb6",
//         "40": "#ff7eb6",
//         "41": "#ff7eb6",
//         "42": "#ff7eb6",
//         "43": "#ff7eb6",
//         "44": "#ff7eb6",
//         "45": "#ff7eb6",
//         "46": "#ff7eb6",
//         "47": "#ff7eb6",
//         "48": "#ff7eb6",
//         "49": "#ff7eb6",
//         "50": "#ff7eb6",
//         "51": "#ff7eb6",
//         "52": "#ff7eb6",
//         "53": "#ff7eb6",
//         "54": "#ff7eb6",
//         "55": "#ff7eb6",
//         "56": "#ff7eb6",
//         "57": "#ff7eb6",
//         "58": "#ff7eb6",
//         "59": "#ff7eb6",
//         "60": "#ff7eb6",
//         "61": "#ff7eb6",
//         "62": "#ff7eb6",
//         "63": "#ff7eb6",
//         "64": "#ff7eb6",
//         "65": "#ff7eb6"
//     },
//     "4": {
//         "0": "#ff7eb6",
//         "1": "#ff7eb6",
//         "2": "#ff7eb6",
//         "3": "#ff7eb6",
//         "4": "#ff7eb6",
//         "5": "#ff7eb6",
//         "6": "#ff7eb6",
//         "7": "#ff7eb6",
//         "8": "#ff7eb6",
//         "9": "#ff7eb6",
//         "10": "#ff7eb6",
//         "11": "#ff7eb6",
//         "12": "#ff7eb6",
//         "13": "#ff7eb6",
//         "14": "#ff7eb6",
//         "15": "#ff7eb6",
//         "16": "#ff7eb6",
//         "17": "#ff7eb6",
//         "18": "#ff7eb6",
//         "19": "#ff7eb6",
//         "20": "#ff7eb6",
//         "21": "#ff7eb6",
//         "22": "#ff7eb6",
//         "23": "#ff7eb6",
//         "24": "#ff7eb6",
//         "25": "#ff7eb6",
//         "26": "#ff7eb6",
//         "27": "#ff7eb6",
//         "28": "#ff7eb6",
//         "29": "#ff7eb6",
//         "30": "#ff7eb6",
//         "31": "#ff7eb6",
//         "32": "#ff7eb6",
//         "33": "#ff7eb6",
//         "34": "#ff7eb6",
//         "35": "#ff7eb6",
//         "36": "#ff7eb6",
//         "37": "#ff7eb6",
//         "38": "#ff7eb6",
//         "39": "#ff7eb6",
//         "40": "#ff7eb6",
//         "41": "#ff7eb6",
//         "42": "#ff7eb6",
//         "43": "#ff7eb6",
//         "44": "#ff7eb6",
//         "45": "#ff7eb6",
//         "46": "#ff7eb6",
//         "47": "#ff7eb6",
//         "48": "#ff7eb6",
//         "49": "#ff7eb6",
//         "50": "#ff7eb6",
//         "51": "#ff7eb6",
//         "52": "#ff7eb6",
//         "53": "#ff7eb6",
//         "54": "#ff7eb6",
//         "55": "#ff7eb6",
//         "56": "#ff7eb6",
//         "57": "#ff7eb6",
//         "58": "#ff7eb6",
//         "59": "#ff7eb6",
//         "60": "#ff7eb6",
//         "61": "#ff7eb6",
//         "62": "#ff7eb6",
//         "63": "#ff7eb6",
//         "64": "#ff7eb6",
//         "65": "#ff7eb6"
//     },
//     "cell_size": 10
// } as PixelJSON

export const Program = ({
  children,
  program_name,
  bar_color,
  zIndex,
  program_id,
  extra_params,

  draggable,
  className,
}: ProgramProps) => {
  useDragging({
    element_id: `title-bar-program_id-${program_id}`,
    parent_id: `program-program_name-${program_id}`,
    program_id: program_id,
    program_name: program_name,
    extra_params:extra_params,
    disabled: !draggable || false,
  });
  const { changeActiveProgram, activeProgramId } = useDesktopContext();
  const router = useRouter();
  const handleProgramClick = useCallback(() => {
    // router.push(`/?program=${program_name}`);
    if (activeProgramId !== program_id) {
      changeActiveProgram({ program_id });
    }
  }, [activeProgramId, changeActiveProgram, program_id]);

  return (
    <div
      // passHref={true}
      draggable={false}
      // href={`/?program=${program_name}`}
      id={`program-program_name-${program_id}`}
      className={
        className
          ? `${className} program-color-${bar_color} absolute `
          : `${
              router.query.program == program_name
                ? "active-program"
                : "inactive-program"
            }  program program-color-${bar_color} absolute   box-border flex h-1/2 w-2/3 max-w-4xl flex-col items-center justify-center self-center bg-${bar_color}  p-2 `
      }
      onClick={handleProgramClick}
    >
      <div className={`flex w-full flex-row items-center justify-center bg-${bar_color}`}>
        <TitleBar
          program_id={program_id}
          bar_color={bar_color}
          program_name={program_name}
        />
        {/* <button className=" w-5 h-5  border-dark mx-2 ml-1 text-dark text-center">
          -
        </button> */}
        {draggable && (
          <button className=" clickable  mx-2 ml-0  text-4xl  text-lighter-200  ">
            x
          </button>
        )}
      </div>
      <ProgramContent>{children}</ProgramContent>
    </div>
  );
};
